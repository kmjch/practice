from datetime import datetime
d = datetime.now()
dtstamp = d.strftime("%Y%m%dT%H%M%S")

event_name = raw_input("Event name: ")
location = raw_input("Location: ")

filename = event_name + ".ics"

file_object = open(filename, 'w')
file_object.write("BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//Apple Inc.//Mac OS X 10.12.5//EN\nCALSCALE:GREGORIAN\nBEGIN:VTIMEZONE\nTZID:America/Los_Angeles\nBEGIN:DAYLIGHT\nTZOFFSETFROM:-0800\nRRULE:FREQ=YEARLY;BYMONTH=3;BYDAY=2SU\nDTSTART:20070311T020000\nTZNAME:PDT\nTZOFFSETTO:-0700\nEND:DAYLIGHT\nBEGIN:STANDARD\nTZOFFSETFROM:-0700\nRRULE:FREQ=YEARLY;BYMONTH=11;BYDAY=1SU\nDTSTART:20071104T020000\nTZNAME:PST\nTZOFFSETTO:-0800\nEND:STANDARD\nEND:VTIMEZONE\nBEGIN:VEVENT\nTRANSP:OPAQUE\nDTEND;TZID=America/Los_Angeles:20170809T100000\nUID:A235E844-03E6-4C2C-8726-ED7CF15047C5\nDTSTAMP:" + dtstamp + "\nLOCATION:" + location + "\nDESCRIPTION:\nSTATUS:CONFIRMED\nSEQUENCE:0\nX-APPLE-TRAVEL-ADVISORY-BEHAVIOR:AUTOMATIC\nSUMMARY:" + event_name + "\nDTSTART;TZID=America/Los_Angeles:20170809T090000\nCREATED:20170808T181646Z\nLAST-MODIFIED:20170808T181646Z\nEND:VEVENT\nEND:VCALENDAR")
file_object.close()

print "Event", event_name, "created"
